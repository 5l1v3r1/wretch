!function(t,r){"object"==typeof exports&&"undefined"!=typeof module?module.exports=r():"function"==typeof define&&define.amd?define(r):t.wretch=r()}(this,function(){"use strict";const t=Object.assign||function(t){for(var r,o=1;o<arguments.length;o++){r=arguments[o];for(var e in r)Object.prototype.hasOwnProperty.call(r,e)&&(t[e]=r[e])}return t};var r=function(o,e,n){if(void 0===n&&(n=!1),!o||!e||"object"!=typeof o||"object"!=typeof e)return o;var i=t({},o);for(var s in e)e.hasOwnProperty(s)&&(e[s]instanceof Array&&o[s]instanceof Array?i[s]=n?o[s].concat(e[s]):e[s]:"object"==typeof e[s]&&"object"==typeof o[s]?i[s]=r(o[s],e[s],n):i[s]=e[s]);return i},o={defaults:{},errorType:null,polyfills:{fetch:null,FormData:null,URLSearchParams:null,performance:null,PerformanceObserver:null,AbortController:null},polyfill:function(t,r,o){void 0===r&&(r=!0),void 0===o&&(o=!1);for(var e=[],n=3;n<arguments.length;n++)e[n-3]=arguments[n];var i=this.polyfills[t]||("undefined"!=typeof self?self[t]:null)||("undefined"!=typeof global?global[t]:null);if(r&&!i)throw new Error(t+" is not defined");return o&&i?new(i.bind.apply(i,[void 0].concat(e))):i}},e=function(t,r,o,e){var n=t.getEntriesByName(r);return!!(n&&n.length>0)&&(o(n.reverse()[0]),e.clearMeasures(r),i.callbacks.delete(r),i.callbacks.size<1&&(i.observer.disconnect(),e.clearResourceTimings&&e.clearResourceTimings()),!0)},n=function(t,r){return!i.observer&&t&&r&&(i.observer=new r(function(r){i.callbacks.forEach(function(o,n){e(r,n,o,t)})}),t.clearResourceTimings&&t.clearResourceTimings()),i.observer},i={callbacks:new Map,observer:null,observe:function(t,r){if(t&&r){var s=o.polyfill("performance",!1),u=o.polyfill("PerformanceObserver",!1);n(s,u)&&(e(s,t,r,s)||(i.callbacks.size<1&&i.observer.observe({entryTypes:["resource","measure"]}),i.callbacks.set(t,r)))}}},s=function(t){return function(e){return void 0===e&&(e=new Map),function(n){void 0===n&&(n={});var s=r(o.defaults,n),u=o.polyfill("AbortController",!1,!0);!s.signal&&u&&(s.signal=u.signal);var c=o.polyfill("fetch")(t,s),a=c.then(function(t){return t.ok?t:t[o.errorType||"text"]().then(function(r){var e=new Error(r);throw e[o.errorType]=r,e.status=t.status,e.response=t,e})}),f=function(t){return t.catch(function(t){if(e.has(t.status))e.get(t.status)(t);else{if(!e.has(t.name))throw t;e.get(t.name)(t)}})},l=function(t){return function(r){return f(t?a.then(function(r){return r&&r[t]()}).then(function(t){return t&&r&&r(t)||t}):a.then(function(t){return t&&r&&r(t)||t}))}},p={res:l(null),json:l("json"),blob:l("blob"),formData:l("formData"),arrayBuffer:l("arrayBuffer"),text:l("text"),perfs:function(t){return c.then(function(r){return i.observe(r.url,t)}),p},setTimeout:function(t,r){return void 0===r&&(r=u),setTimeout(function(){return r.abort()},t),p},controller:function(){return[u,p]},error:function(t,r){return e.set(t,r),p},badRequest:function(t){return p.error(400,t)},unauthorized:function(t){return p.error(401,t)},forbidden:function(t){return p.error(403,t)},notFound:function(t){return p.error(404,t)},timeout:function(t){return p.error(408,t)},internalError:function(t){return p.error(500,t)},onAbort:function(t){return p.error("AbortError",t)}};return p}}},u=function(){function e(t,r,o){void 0===r&&(r={}),void 0===o&&(o=new Map),this._url=t,this._options=r,this._catchers=o}return e.factory=function(t,r){return void 0===t&&(t=""),void 0===r&&(r={}),new e(t,r)},e.prototype.selfFactory=function(t){var r=void 0===t?{}:t,o=r.url,n=void 0===o?this._url:o,i=r.options,s=void 0===i?this._options:i,u=r.catchers;return new e(n,s,void 0===u?this._catchers:u)},e.prototype.defaults=function(t,e){return void 0===e&&(e=!1),o.defaults=e?o.defaults=r(o.defaults,t):t,this},e.prototype.errorType=function(t){return o.errorType=t,this},e.prototype.polyfills=function(r){return o.polyfills=t({},o.polyfills,r),this},e.prototype.url=function(t,r){return void 0===r&&(r=!1),r?this.selfFactory({url:t}):this.selfFactory({url:this._url+t})},e.prototype.options=function(t,o){return void 0===o&&(o=!0),this.selfFactory({options:o?r(this._options,t):t})},e.prototype.query=function(t){return this.selfFactory({url:c(this._url,t)})},e.prototype.headers=function(t){return this.selfFactory({options:r(this._options,{headers:t})})},e.prototype.accept=function(t){return this.headers({Accept:t})},e.prototype.content=function(t){return this.headers({"Content-Type":t})},e.prototype.auth=function(t){return this.headers({Authorization:t})},e.prototype.catcher=function(t,r){var o=new Map(this._catchers);return o.set(t,r),this.selfFactory({catchers:o})},e.prototype.signal=function(r){return this.selfFactory({options:t({},this._options,{signal:r.signal})})},e.prototype.get=function(t){return void 0===t&&(t={}),s(this._url)(this._catchers)(r(t,this._options))},e.prototype.delete=function(o){return void 0===o&&(o={}),s(this._url)(this._catchers)(t({},r(o,this._options),{method:"DELETE"}))},e.prototype.put=function(o){return void 0===o&&(o={}),s(this._url)(this._catchers)(t({},r(o,this._options),{method:"PUT"}))},e.prototype.post=function(o){return void 0===o&&(o={}),s(this._url)(this._catchers)(t({},r(o,this._options),{method:"POST"}))},e.prototype.patch=function(o){return void 0===o&&(o={}),s(this._url)(this._catchers)(t({},r(o,this._options),{method:"PATCH"}))},e.prototype.head=function(o){return void 0===o&&(o={}),s(this._url)(this._catchers)(t({},r(o,this._options),{method:"HEAD"}))},e.prototype.opts=function(o){return void 0===o&&(o={}),s(this._url)(this._catchers)(t({},r(o,this._options),{method:"OPTIONS"}))},e.prototype.body=function(r){return this.selfFactory({options:t({},this._options,{body:r})})},e.prototype.json=function(t){return this.content("application/json").body(JSON.stringify(t))},e.prototype.formData=function(t){return this.body(a(t))},e.prototype.formUrl=function(t){return this.body("string"==typeof t?t:f(t)).content("application/x-www-form-urlencoded")},e}(),c=function(t,r){var e=o.polyfill("URLSearchParams",!0,!0),n=t.indexOf("?");for(var i in r)if(r[i]instanceof Array)for(var s=0,u=r[i];s<u.length;s++){var c=u[s];e.append(i,c)}else e.append(i,r[i]);return~n?t.substring(0,n)+"?"+e.toString():t+"?"+e.toString()},a=function(t){var r=o.polyfill("FormData",!0,!0);for(var e in t)if(t[e]instanceof Array)for(var n=0,i=t[e];n<i.length;n++){var s=i[n];r.append(e+"[]",s)}else r.append(e,t[e]);return r},f=function(t){return Object.keys(t).map(function(r){return encodeURIComponent(r)+"="+encodeURIComponent("object"==typeof t[r]?JSON.stringify(t[r]):t[r])}).join("&")};return u.factory});
//# sourceMappingURL=wretch.js.map
